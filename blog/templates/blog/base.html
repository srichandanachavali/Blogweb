{% load static %}
<!DOCTYPE html>
<html lang="en" data-theme="{{ active_theme|default:'light' }}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Blogweb{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'blog/css/style.css' %}" />
    
    <style>
      :root {
        --accent-color: {{ accent_color|default:"#ff4f70" }};
      }
    </style>
    <style>
      body::before {
        content: ""; /* Required for a pseudo-element */
        position: fixed; /* Stays in place when you scroll */
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        
        /* This path is correct based on your screenshot */
        background-image: url("{% static 'images/cinema_bg.png' %}");
        
        background-size: cover;
        background-position: center center;
        
        opacity: 0.05; /* Try 0.05, 0.1, or 0.15 */
        
        z-index: -1;
      }
    </style>
    <style>
      .brand-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        padding: 0.5rem 0.5rem;
      }

      .brand-link {
        display: flex;
        align-items: center;
        text-decoration: none;
        gap: 10px;
      }

      .brand-logo {
        width: 40px;
        height: 40px;
        object-fit: contain;
      }

      .brand-name {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        font-weight: 700;
        font-size: 1.75rem;
        color: var(--text-color, #222);
        letter-spacing: -0.5px;
      }

      .app-header {
        justify-content: space-between;
      }

      .settings-link-simple {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        background: none;
        border: none;
        padding: 0 0.5rem;
        font-size: 1.5rem;
        color: var(--text-color-muted, #888);
        transition: color 0.2s ease;
      }
      .settings-link-simple:hover {
        color: var(--text-color, #222);
      }
    </style>
  </head>
  <body>
    <header class="app-header">
      <div class="brand-container">
        <a
          class="brand-link"
          href="{% url 'post_list' %}"
          aria-label="Go to homepage"
        >
          <img
            src="{% static 'images/cinesyndicate_logo.png' %}"
            alt="CineSyndicate Logo"
            class="brand-logo"
          />
          <span class="brand-name">CineSyndicate</span>
        </a>
      </div>

      <div class="header-controls">
        <div class="auth-links">
          {% if user.is_authenticated %}

          <a class="button ghost" href="{% url 'post_create' %}">Create</a>
          <a class="button" href="{% url 'logout' %}">Logout</a>
          <a
            class="settings-link-simple"
            href="{% url 'settings' %}"
            aria-label="Appearance and profile settings"
          >
            ⚙️
          </a>
          <a class="avatar" href="{% url 'profile' %}">
            {% if user_profile and user_profile.image %}
            <img
              src="{{ user_profile.image.url }}"
              alt="{{ user.username }} avatar"
            />
            {% else %}
            <span>{{ user.username|first|upper }}</span>
            {% endif %}
          </a>

          {% else %}
          <a class="button ghost" href="{% url 'login' %}">Login</a>
          <a class="button" href="{% url 'register' %}">Sign Up</a>
          {% endif %}
        </div>
      </div>
    </header>

    {% if messages %}
    <div class="flash-messages">
      {% for message in messages %}
      <div class="flash {{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
    {% endif %}
    <main class="layout">{% block content %}{% endblock %}</main>
    <footer class="app-footer">
      <p>Built with ❤️ for storytellers.</p>
    </footer>

    <script>
      document.documentElement.dataset.theme =
        document.documentElement.dataset.theme || "light";
      const accent = "{{ accent_color|default:'#ff4f70' }}";
      if (accent) {
        document.documentElement.style.setProperty("--accent-color", accent);
      }
      document.querySelectorAll("[data-share-profile]").forEach((button) => {
        button.addEventListener("click", () => {
          const url = button.getAttribute("data-share-profile");
          if (navigator.share) {
            navigator.share({ url }).catch(() => {
              if (navigator.clipboard) {
                navigator.clipboard.writeText(url);
              }
            });
          } else if (navigator.clipboard) {
            navigator.clipboard.writeText(url);
          }
          button.classList.add("shared");
          setTimeout(() => button.classList.remove("shared"), 1500);
        });
      });
      document.querySelectorAll("[data-subscribe-toggle]").forEach((button) => {
        button.addEventListener("click", () => {
          const active = button.classList.toggle("is-active");
          button.textContent = active ? "Subscribed" : "Subscribe";
          button.setAttribute("aria-pressed", active ? "true" : "false");
        });
      });
      document.querySelectorAll(".theme-option input").forEach((input) => {
        input.addEventListener("change", () => {
          document.querySelectorAll(".theme-option").forEach((option) => {
            option.classList.toggle(
              "is-active",
              option.contains(input) && input.checked
            );
          });
        });
      });
      const accentPicker = document.querySelector("#accent-color");
      if (accentPicker) {
        accentPicker.addEventListener("input", (event) => {
          document.documentElement.style.setProperty(
            "--accent-color",
            event.target.value
          );
        });
      }
    </script>
  </body>
</html>